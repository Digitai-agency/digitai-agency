<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>DigitAI - Create Your Website</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap");

      * {
        font-family: "Inter", sans-serif;
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      /* Dark Mode */
      body.dark-mode {
        background-color: #0f0f0f;
        color: #e5e5e5;
      }

      body.dark-mode .header {
        background-color: #171717;
        border-bottom: 1px solid #2a2a2a;
      }

      body.dark-mode .chat-container {
        background-color: #0f0f0f;
      }

      body.dark-mode .message-ai {
        background-color: #171717;
      }

      body.dark-mode .input-area {
        background-color: #171717;
        border-top: 1px solid #2a2a2a;
      }

      body.dark-mode .textarea-input {
        background-color: #2a2a2a;
        border: 1px solid #3a3a3a;
        color: #e5e5e5;
      }

      body.dark-mode .settings-panel {
        background-color: #171717;
        border-bottom: 1px solid #2a2a2a;
      }

      body.dark-mode input[type="text"],
      body.dark-mode input[type="password"] {
        background-color: #2a2a2a;
        border: 1px solid #3a3a3a;
        color: #e5e5e5;
      }

      /* Light Mode */
      body.light-mode {
        background-color: #ffffff;
        color: #1f1f1f;
      }

      body.light-mode .header {
        background-color: #ffffff;
        border-bottom: 1px solid #e5e5e5;
      }

      body.light-mode .chat-container {
        background-color: #ffffff;
      }

      body.light-mode .message-ai {
        background-color: #f7f7f8;
      }

      body.light-mode .input-area {
        background-color: #ffffff;
        border-top: 1px solid #e5e5e5;
      }

      body.light-mode .textarea-input {
        background-color: #f7f7f8;
        border: 1px solid #e5e5e5;
        color: #1f1f1f;
      }

      body.light-mode .settings-panel {
        background-color: #ffffff;
        border-bottom: 1px solid #e5e5e5;
      }

      body.light-mode input[type="text"],
      body.light-mode input[type="password"] {
        background-color: #f7f7f8;
        border: 1px solid #e5e5e5;
        color: #1f1f1f;
      }

      .header {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        z-index: 100;
        height: 60px;
      }

      .chat-container {
        position: fixed;
        top: 60px;
        bottom: 120px;
        left: 0;
        right: 0;
        overflow-y: auto;
        padding: 20px;
      }

      .input-area {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        padding: 20px;
      }

      .chat-wrapper {
        max-width: 800px;
        margin: 0 auto;
      }

      .message {
        margin-bottom: 24px;
        animation: fadeIn 0.3s ease-in;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .message-ai {
        padding: 16px 20px;
        border-radius: 16px;
        margin-bottom: 8px;
      }

      .message-user {
        background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
        color: white;
        padding: 16px 20px;
        border-radius: 16px;
        margin-left: auto;
        max-width: 80%;
      }

      .textarea-input {
        width: 100%;
        min-height: 52px;
        max-height: 200px;
        padding: 14px 50px 14px 16px;
        border-radius: 26px;
        resize: none;
        font-size: 15px;
        line-height: 24px;
        overflow-y: auto;
      }

      .textarea-input:focus {
        outline: none;
        border-color: #6366f1;
      }

      .send-button {
        position: absolute;
        right: 8px;
        bottom: 8px;
        width: 36px;
        height: 36px;
        background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: transform 0.2s;
      }

      .send-button:hover {
        transform: scale(1.05);
      }

      .send-button:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      .icon-button {
        background: none;
        border: none;
        cursor: pointer;
        padding: 8px;
        border-radius: 8px;
        transition: background-color 0.2s;
      }

      .dark-mode .icon-button:hover {
        background-color: #2a2a2a;
      }

      .light-mode .icon-button:hover {
        background-color: #f0f0f0;
      }

      .settings-panel {
        position: fixed;
        top: 60px;
        left: 0;
        right: 0;
        padding: 20px;
        z-index: 99;
        display: none;
      }

      .settings-panel.active {
        display: block;
      }

      .typing-indicator {
        display: flex;
        gap: 4px;
        padding: 16px 20px;
      }

      .typing-indicator span {
        width: 8px;
        height: 8px;
        background-color: #6366f1;
        border-radius: 50%;
        animation: bounce 1.4s infinite ease-in-out;
      }

      .typing-indicator span:nth-child(1) {
        animation-delay: -0.32s;
      }

      .typing-indicator span:nth-child(2) {
        animation-delay: -0.16s;
      }

      @keyframes bounce {
        0%,
        80%,
        100% {
          transform: scale(0.8);
          opacity: 0.5;
        }
        40% {
          transform: scale(1);
          opacity: 1;
        }
      }

      .scrollbar-custom::-webkit-scrollbar {
        width: 8px;
      }

      .dark-mode .scrollbar-custom::-webkit-scrollbar-track {
        background: #171717;
      }

      .light-mode .scrollbar-custom::-webkit-scrollbar-track {
        background: #f7f7f8;
      }

      .scrollbar-custom::-webkit-scrollbar-thumb {
        background: #6366f1;
        border-radius: 4px;
      }

      .scrollbar-custom::-webkit-scrollbar-thumb:hover {
        background: #8b5cf6;
      }
    </style>
  </head>
  <body class="dark-mode">
    <!-- Header -->
    <div class="header">
      <div
        class="chat-wrapper"
        style="
          height: 100%;
          display: flex;
          align-items: center;
          justify-content: space-between;
          padding: 0 20px;
        "
      >
        <div style="display: flex; align-items: center; gap: 12px">
          <div
            style="
              width: 32px;
              height: 32px;
              background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
              border-radius: 8px;
              display: flex;
              align-items: center;
              justify-content: center;
            "
          >
            <svg
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="white"
              stroke-width="2"
            >
              <path
                d="M8 9l3 3-3 3m5 0h3M5 20h14a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"
              ></path>
            </svg>
          </div>
          <div>
            <div style="font-size: 16px; font-weight: 600">DigitAI</div>
            <div style="font-size: 12px; opacity: 0.6">
              Websites built in chat
            </div>
          </div>
        </div>
        <div style="display: flex; gap: 8px">
          <button class="icon-button" id="themeToggleBtn" type="button">
            <svg
              id="darkIcon"
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
            </svg>
            <svg
              id="lightIcon"
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              style="display: none"
            >
              <circle cx="12" cy="12" r="5"></circle>
              <line x1="12" y1="1" x2="12" y2="3"></line>
              <line x1="12" y1="21" x2="12" y2="23"></line>
              <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
              <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
              <line x1="1" y1="12" x2="3" y2="12"></line>
              <line x1="21" y1="12" x2="23" y2="12"></line>
              <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
              <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
            </svg>
          </button>
          <button class="icon-button" id="settingsToggleBtn" type="button">
            <svg
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <circle cx="12" cy="12" r="3"></circle>
              <path d="M12 1v6m0 6v6m9-9h-6m-6 0H3"></path>
            </svg>
          </button>
        </div>
      </div>
    </div>

    <!-- Settings Panel -->
    <div class="settings-panel" id="settingsPanel">
      <div class="chat-wrapper">
        <h3 style="font-size: 18px; font-weight: 600; margin-bottom: 16px">
          API Configuration
        </h3>
        <div style="display: flex; flex-direction: column; gap: 16px">
          <div>
            <label
              style="
                display: block;
                font-size: 14px;
                margin-bottom: 8px;
                opacity: 0.8;
              "
              >API Endpoint</label
            >
            <input
              type="text"
              id="apiEndpoint"
              placeholder="https://api.example.com/chat"
              style="
                width: 100%;
                padding: 12px;
                border-radius: 12px;
                font-size: 14px;
              "
            />
          </div>
          <div>
            <label
              style="
                display: block;
                font-size: 14px;
                margin-bottom: 8px;
                opacity: 0.8;
              "
              >API Key</label
            >
            <input
              type="password"
              id="apiKey"
              placeholder="Enter your API key"
              style="
                width: 100%;
                padding: 12px;
                border-radius: 12px;
                font-size: 14px;
              "
            />
          </div>
          <button
            id="saveSettingsBtn"
            style="
              background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
              color: white;
              padding: 12px 24px;
              border: none;
              border-radius: 12px;
              font-weight: 500;
              cursor: pointer;
            "
          >
            Save Settings
          </button>
        </div>
      </div>
    </div>

    <!-- Chat Container -->
    <div class="chat-container scrollbar-custom" id="chatContainer">
      <div class="chat-wrapper">
        <!-- Welcome Message -->
        <div class="message">
          <div style="display: flex; gap: 12px; margin-bottom: 8px">
            <div
              style="
                width: 32px;
                height: 32px;
                background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
                border-radius: 50%;
                flex-shrink: 0;
                display: flex;
                align-items: center;
                justify-content: center;
              "
            >
              <svg
                width="18"
                height="18"
                viewBox="0 0 24 24"
                fill="none"
                stroke="white"
                stroke-width="2"
              >
                <path d="M13 10V3L4 14h7v7l9-11h-7z"></path>
              </svg>
            </div>
            <div style="flex: 1">
              <div
                style="font-weight: 600; font-size: 14px; margin-bottom: 4px"
              >
                DigitAI
              </div>
              <div class="message-ai">
                <p style="margin-bottom: 12px">
                  ðŸ‘‹ Welcome to DigitAI! No calls. No meetings. Just chat.
                </p>
                <p style="margin-bottom: 12px">
                  I'll help you build a professional website through this
                  conversation. AI does the heavy lifting â€” we ensure it's
                  on-brand and polished.
                </p>
                <p style="font-weight: 500">
                  Let's get started! What's the name of your business?
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Input Area -->
    <div class="input-area">
      <div class="chat-wrapper">
        <div style="position: relative">
          <textarea
            id="messageInput"
            class="textarea-input scrollbar-custom"
            placeholder="Message DigitAI... (Shift+Enter for new line)"
            rows="1"
          ></textarea>
          <button class="send-button" id="sendButton" type="button">
            <svg
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="white"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <line x1="22" y1="2" x2="11" y2="13"></line>
              <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
            </svg>
          </button>
        </div>
        <div
          style="
            font-size: 12px;
            opacity: 0.6;
            margin-top: 8px;
            text-align: center;
          "
        >
          Chat-first. Iterate fast. Ship continuously.
        </div>
      </div>
    </div>

    <script>
      // Theme Toggle
      const body = document.body;
      const themeToggleBtn = document.getElementById("themeToggleBtn");
      const darkIcon = document.getElementById("darkIcon");
      const lightIcon = document.getElementById("lightIcon");

      themeToggleBtn.addEventListener("click", function (e) {
        e.preventDefault();
        console.log("Theme toggle clicked");

        if (body.classList.contains("dark-mode")) {
          body.classList.remove("dark-mode");
          body.classList.add("light-mode");
          darkIcon.style.display = "none";
          lightIcon.style.display = "block";
        } else {
          body.classList.remove("light-mode");
          body.classList.add("dark-mode");
          darkIcon.style.display = "block";
          lightIcon.style.display = "none";
        }
      });

      // Settings Toggle
      const settingsToggleBtn = document.getElementById("settingsToggleBtn");
      const settingsPanel = document.getElementById("settingsPanel");

      settingsToggleBtn.addEventListener("click", function (e) {
        e.preventDefault();
        console.log("Settings toggle clicked");
        settingsPanel.classList.toggle("active");
      });

      // API Configuration
      let apiConfig = {
        endpoint: "",
        apiKey: "",
      };

      const saveSettingsBtn = document.getElementById("saveSettingsBtn");
      const apiEndpoint = document.getElementById("apiEndpoint");
      const apiKey = document.getElementById("apiKey");

      saveSettingsBtn.addEventListener("click", function (e) {
        e.preventDefault();
        console.log("Save settings clicked");
        apiConfig.endpoint = apiEndpoint.value;
        apiConfig.apiKey = apiKey.value;
        settingsPanel.classList.remove("active");
        alert("Settings saved successfully!");
      });

      // Chat functionality
      const chatContainer = document.getElementById("chatContainer");
      const messageInput = document.getElementById("messageInput");
      const sendButton = document.getElementById("sendButton");
      let conversationHistory = [];

      // Auto-resize textarea
      messageInput.addEventListener("input", function () {
        this.style.height = "auto";
        this.style.height = Math.min(this.scrollHeight, 200) + "px";
      });

      // Handle Shift+Enter for new line
      messageInput.addEventListener("keydown", function (e) {
        if (e.key === "Enter" && !e.shiftKey) {
          e.preventDefault();
          sendMessage();
        }
      });

      // Send button click
      sendButton.addEventListener("click", function (e) {
        e.preventDefault();
        console.log("Send button clicked");
        sendMessage();
      });

      function addMessage(content, isUser = false) {
        const messageDiv = document.createElement("div");
        messageDiv.className = "message";

        const formattedContent = content.replace(/\n/g, "<br>");

        if (isUser) {
          messageDiv.innerHTML = `
                    <div style="display: flex; justify-content: flex-end;">
                        <div class="message-user">
                            ${formattedContent}
                        </div>
                    </div>
                `;
        } else {
          messageDiv.innerHTML = `
                    <div style="display: flex; gap: 12px;">
                        <div style="width: 32px; height: 32px; background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); border-radius: 50%; flex-shrink: 0; display: flex; align-items: center; justify-content: center;">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                                <path d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                            </svg>
                        </div>
                        <div style="flex: 1;">
                            <div style="font-weight: 600; font-size: 14px; margin-bottom: 4px;">DigitAI</div>
                            <div class="message-ai">
                                ${formattedContent}
                            </div>
                        </div>
                    </div>
                `;
        }

        const wrapper = chatContainer.querySelector(".chat-wrapper");
        wrapper.appendChild(messageDiv);
        chatContainer.scrollTop = chatContainer.scrollHeight;
      }

      function showTypingIndicator() {
        const typingDiv = document.createElement("div");
        typingDiv.id = "typingIndicator";
        typingDiv.className = "message";
        typingDiv.innerHTML = `
                <div style="display: flex; gap: 12px;">
                    <div style="width: 32px; height: 32px; background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); border-radius: 50%; flex-shrink: 0; display: flex; align-items: center; justify-content: center;">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                            <path d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                        </svg>
                    </div>
                    <div style="flex: 1;">
                        <div style="font-weight: 600; font-size: 14px; margin-bottom: 4px;">DigitAI</div>
                        <div class="message-ai">
                            <div class="typing-indicator">
                                <span></span>
                                <span></span>
                                <span></span>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        const wrapper = chatContainer.querySelector(".chat-wrapper");
        wrapper.appendChild(typingDiv);
        chatContainer.scrollTop = chatContainer.scrollHeight;
      }

      function removeTypingIndicator() {
        const indicator = document.getElementById("typingIndicator");
        if (indicator) {
          indicator.remove();
        }
      }

      async function callLLMAPI(message) {
        if (!apiConfig.endpoint) {
          return "Please configure your API settings first by clicking the settings icon.";
        }

        try {
          conversationHistory.push({
            role: "user",
            content: message,
          });

          const response = await fetch(apiConfig.endpoint, {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
              Authorization: `Bearer ${apiConfig.apiKey}`,
            },
            body: JSON.stringify({
              model: "gpt-4o-mini",
              messages: conversationHistory,
              temperature: 0.7,
              max_tokens: 500,
            }),
          });

          if (!response.ok) {
            throw new Error(`API Error: ${response.status}`);
          }

          const data = await response.json();
          let assistantMessage = "";

          if (data.choices && data.choices[0]?.message?.content) {
            assistantMessage = data.choices[0].message.content;
          } else if (data.content && data.content[0]?.text) {
            assistantMessage = data.content[0].text;
          } else if (data.message) {
            assistantMessage = data.message;
          } else {
            assistantMessage = JSON.stringify(data);
          }

          conversationHistory.push({
            role: "assistant",
            content: assistantMessage,
          });

          return assistantMessage;
        } catch (error) {
          console.error("API Error:", error);
          return `Sorry, I encountered an error: ${error.message}. Please check your API configuration.`;
        }
      }

      async function sendMessage() {
        const message = messageInput.value.trim();
        if (!message) return;

        console.log("Sending message:", message);

        addMessage(message, true);
        messageInput.value = "";
        messageInput.style.height = "auto";

        showTypingIndicator();
        const response = await callLLMAPI(message);
        removeTypingIndicator();
        addMessage(response, false);
      }

      messageInput.focus();
    </script>
  </body>
</html>
